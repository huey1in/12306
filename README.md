# 12306火车票订票工具

## 免责声明

**本工具仅供个人学习、研究和交流使用，不得用于任何商业、营利或非法目的。使用本工具即表示您已充分理解并同意下述所有免责声明。**

### 一、基本声明

1. **学习研究工具** - 本工具仅为学习和研究Python编程、Web自动化、API接口等技术而开发，并非为了获取商业利益。

2. **非官方工具** - 本工具为第三方开发的非官方工具，与中国铁路集团有限公司、12306网站及其任何关联方无任何关系。

3. **技术演示性质** - 本工具仅用于演示和学习如何与Web API交互，不应被用于任何生产环境或大规模操作。

### 二、使用责任

4. **用户独自承担责任** - 用户下载、安装、修改或使用本工具的任何版本而产生的所有后果，包括但不限于数据丢失、账户被禁用、经济损失、法律诉讼等，均由用户自行承担全部责任。

5. **作者免责** - 作者不承担因本工具使用而产生的任何直接或间接责任，包括但不限于：
   - 因网络故障、服务器错误导致的购票失败或错误
   - 因账户被12306官方标记为异常而被限制
   - 因自动化操作导致的任何经济损失
   - 因信息泄露导致的个人隐私问题
   - 因违反12306服务条款而遭受的任何处罚

6. **风险自担** - 用户在使用本工具时需充分认识到以下风险：
   - 账户可能被12306官方标记为风险账户
   - 购票请求可能被系统拒绝
   - 登录凭证可能在本地存储过程中被盗取
   - 自动化操作可能违反12306的服务条款

### 三、法律合规

7. **遵守法律法规** - 用户使用本工具必须严格遵守中华人民共和国的所有适用法律、法规和规定，包括但不限于：
   - 《计算机软件保护条例》
   - 《网络安全法》
   - 《个人信息保护法》
   - 《刑法》第286条（非法侵入计算机系统罪）
   - 《刑法》第285条（故意制作、传播计算机病毒罪）
   - 12306网站的《用户协议》和《服务条款》

8. **禁止不当使用** - 禁止用于以下目的：
   - 商业营利或转卖
   - 大规模自动化抢票（黄牛操作）
   - 骚扰12306官方系统
   - 进行任何形式的诈骗或欺诈
   - 侵犯他人隐私或知识产权
   - 任何其他非法或不当的目的

9. **服务条款冲突** - 本工具的使用可能违反12306官方网站的服务条款。用户在使用本工具时应自行判断其合法性，作者不对此承担任何责任。

### 四、数据与隐私

10. **数据安全警告** - 本工具需要用户输入登录凭证，虽然所有信息仅保存在本地，但仍存在以下风险：
    - 本地存储的cookies可能被恶意软件窃取
    - 如果您的电脑被他人访问，凭证可能泄露
    - 网络传输过程中信息可能被拦截
    - 即使采用HTTPS加密，仍存在中间人攻击的可能

11. **不收集信息** - 作者声明本工具不会主动收集、存储、上传或泄露用户的任何个人信息。但用户需注意：
    - 用户输入的账号密码等信息为用户自己保管
    - 本工具的源代码对所有人公开，任何人都可以修改或创建恶意版本
    - 从非官方渠道获得的本工具版本可能被篡改，存在恶意代码风险
    - 建议仅从官方代码仓库（如GitHub）获取本工具

12. **第三方依赖** - 本工具可能依赖第三方库，这些库的安全性不在作者控制范围内。

### 五、功能限制

13. **功能不保证** - 本工具按"现状"提供，不提供任何明示或暗示的保证，包括但不限于：
    - 工具的可用性和可靠性
    - 功能的完整性和正确性
    - 对任何特定目的的适用性
    - 工具不存在漏洞或缺陷

14. **功能可能失效** - 由于12306网站的API和页面结构可能随时改变，本工具的功能可能：
    - 突然失效或无法正常工作
    - 需要频繁更新以适应网站变化
    - 在某些时间段（如春运期间）可能被系统拦截

15. **不提供技术支持** - 作者不保证提供任何技术支持、更新或维护，包括：
    - 不保证及时修复漏洞
    - 不保证及时更新工具以适应网站变化
    - 不保证回复用户的问题或建议

### 六、账户安全

16. **账户风险提示** - 使用本工具可能导致您的12306账户：
    - 被官方标记为异常账户
    - 被限制登录或购票
    - 被永久禁用
    - 遭受官方审查或调查

17. **建议使用独立账户** - 强烈建议用户：
    - 不要使用本工具操作您的主要/常用12306账户
    - 专门为测试创建一个新的12306账户
    - 接受账户可能被禁用的风险

### 七、知识产权

18. **代码许可** - 本工具代码的使用受相关开源许可证约束（如适用）。用户可以：
    - 个人学习和研究
    - 修改代码用于学习目的
    
   用户不应该：
    - 将本工具代码用于商业目的
    - 冒充本工具作者
    - 删除或修改许可证声明

19. **第三方权利** - 本工具与12306网站、铁路部门等任何第三方无关。本工具的版权和知识产权属于作者，受法律保护。

### 八、责任限制

20. **损害赔偿限制** - 在任何情况下，作者不对以下内容承担任何责任，即使已被告知可能发生的损害：
    - 任何数据或信息的丢失或损坏
    - 任何第三方的索赔或诉讼
    - 任何直接、间接、附带、特殊或后果性的损失
    - 任何经济损失或商业损失
    - 您无法使用本工具或获取车票

21. **著作权侵犯** - 如本工具侵犯了任何第三方的著作权、专利权或其他知识产权，用户同意自行承担相关法律后果，与作者无关。

### 九、更新与修改

22. **保留权利** - 作者保留以下权利：
    - 随时修改或终止本工具，不另行通知
    - 随时修改或更新本免责声明
    - 更改工具的许可证或发行方式
    - 拒绝向任何人提供本工具

### 十、适用法律

23. **法律适用** - 本免责声明受中华人民共和国法律管辖。如产生任何纠纷，应向有管辖权的法院提起诉讼。

24. **分项生效** - 如本免责声明的任何条款被认定为无效，不影响其他条款的有效性。

### 十一、最终声明

25. **明确同意** - 用户在下载、安装或使用本工具时，即表示您：
    - 已完整阅读本免责声明
    - 充分理解本工具的所有风险
    - 自愿承担使用本工具的所有后果
    - 明确同意本免责声明的所有条款
    - 放弃向作者追究任何法律责任的权利

26. **没有其他协议** - 本免责声明构成了作者与用户之间关于本工具的完整协议，取代任何以前的口头或书面协议。

---

**最后，作者建议：如果您对本工具的任何方面有疑虑，请不要使用它。您的账户安全和个人隐私比使用本工具更加重要。**

---

## 目录结构

```
12306/
├── main.py                          # 主程序入口
├── cookies.pkl                      # 登录cookies（自动生成）
├── 12306.log                        # 日志文件（自动生成）
├── src/                             # 源代码目录
│   ├── __init__.py
│   ├── utils/                       # 工具模块
│   │   ├── __init__.py
│   │   ├── logger.py               # 日志记录工具
│   │   ├── constants.py            # 常量定义（车站映射等）
│   │   └── helpers.py              # 辅助函数（加密、编码等）
│   ├── services/                    # 业务服务层
│   │   ├── __init__.py
│   │   ├── ticket_debugger.py      # 车票查询服务
│   │   ├── auth_service.py         # 登录认证服务
│   │   ├── cookie_service.py       # Cookie管理服务
│   │   ├── order_query_service.py  # 订单查询服务
│   │   └── order_submit_service.py # 订单提交服务
│   ├── models/                      # 数据模型
│   └── config/                      # 配置文件
└── README.md                        # 项目文档
```

## 模块说明

### src/utils/ - 工具模块

- **logger.py**: 日志记录工具
  - `setup_logging()` - 初始化日志系统
  - `get_logger()` - 获取日志记录器

- **constants.py**: 常量定义
  - `STATION_MAPPING` - 全国车站代码映射表
  - `SEAT_TYPE_MAPPING` - 座位类型映射
  - `DEFAULT_HEADERS` - API请求头

- **helpers.py**: 辅助函数
  - `encrypt_password()` - SM4密码加密
  - `js_escape()` - JavaScript转义编码
  - `format_seat_display()` - 座位显示格式化
  - `decode_train_info()` - 车次信息解码

### src/services/ - 服务层

- **ticket_debugger.py**: 车票查询服务
  - `TrainTicketDebugger` 类 - 负责查询12306 API获取车次信息

- **auth_service.py**: 登录认证服务
  - `AuthService` 类 - 负责用户登录、认证、登录状态检查

- **cookie_service.py**: Cookie管理服务
  - `CookieService` 类 - 负责Cookie的加载和保存

- **order_query_service.py**: 订单查询服务
  - `OrderQueryService` 类 - 负责获取乘客信息、排队人数、订单状态等

- **order_submit_service.py**: 订单提交服务
  - `OrderSubmitService` 类 - 负责提交订单、检查订单、确认排队等

## 主程序说明

**main.py** 中的 `TrainOrderManager` 类整合了所有服务，提供以下功能：

1. **query_trains_only()** - 查询车次信息
2. **auto_book_ticket()** - 自动订票流程
3. **scheduled_grab_ticket()** - 定时抢票流程
4. **login_process()** - 登录流程
5. **check_login_status()** - 检查登录状态

## 注意事项

1. cookies.pkl 会自动保存在项目根目录
3. 日志文件（12306.log）会自动生成

---

---

**特别提示**：请务必在使用本工具前阅读上述免责声明，理解相关风险。

## MIT 开源协议

本项目采用 MIT License 开源协议。

### MIT License 许可内容

MIT License

Copyright (c) 2025

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

### 中文翻译

**MIT许可证**

版权所有 (c) 2025

特此免费授予获得本软件及其关联文档文件（以下称"软件"）副本的任何人，
无限制地处理本软件，包括但不限于使用、复制、修改、合并、发布、分发、
再许可和/或销售本软件的副本，以及许可获得本软件的人士这样做，但须符合以下条件：

上述版权声明和本许可声明应包含在本软件的所有副本或大部分中。

本软件"按原样"提供，不提供任何形式的明示或暗示的担保，
包括但不限于对适销性、特定目的的适用性和非侵权的担保。
在任何情况下，作者或版权持有人均不对任何索赔、损害或其他
责任承担责任，无论是在合同诉讼、侵权诉讼或其他方面产生的，
由软件或软件的使用或其他处理引起的或与之相关的。

### 许可证的含义

**您可以**：
- 自由使用本软件，包括商业和非商业用途
- 复制本软件的源代码
- 修改本软件的源代码
- 分发本软件或修改后的版本
- 在您自己的项目中使用本软件
- 销售包含本软件的产品

**您必须**：
- 在所有副本或重要部分中包含上述版权声明和许可声明
- 保留原始许可证声明

**您不可以**：
- 将作者的名字用于推荐或促销任何衍生产品，除非另行许可

### 免责声明

需要特别注意的是，虽然本项目采用 MIT 许可证，但根据本 README 前面的详细免责声明，
本工具的使用可能涉及法律风险。MIT 许可证并不改变或减轻本工具使用中可能产生的任何法律责任。

用户仍然需要自行判断使用本工具的合法性，并自行承担所有后果。

---
